@using Segurplan.Web.Pages.Models.Administration.ChaptersAndActivities.ChapterDetails;

@model Segurplan.Web.Pages.Models.Administration.ChaptersAndActivities.ChapterDetails.IndexModel
@inject SharedLocalizer L
@*Añadir span para la validacion en todos los input*@


<form enctype="multipart/form-data" method="post">
    <input type="hidden" asp-for="ChapterVersion.Id" />
    <input type="hidden" asp-for="ChapterVersion.IdChapter" />
    <input type="hidden" asp-for="ChapterVersion.RemoveSubChapterIds" id="removeSubchapterIds" />
    <div class="content tabs elec-content-layout">
        <div class="container-fluid">
            <div class="card card-nav-tabs">
                <div class="card-header">
                    <div class="elec-content-title">
                        <div class="row mx-0 py-2 align-items-center">
                            <div class="col">
                                @if (Model.ChapterVersion.Id != 0)
                                {
                                    <h3>@L["ChapterDetails.Header.Title", Model.ChapterVersion.IdChapterNavigation.Number, Model.ChapterVersion.Title]</h3>
                                }
                                else
                                {
                                    <h3>@L["ChapterDetails.New"]</h3>
                                }
                            </div>
                            <div class="col-auto">
                                @if (Model.ChapterVersion.VersionType == ChapterTypeVersionsEnum.CurrentVersion)
                                {
                                    <div class="version_capitulo version_vigente"><span class="fas fa-check-square"></span> <span>@L["ChapterDetails.CurrentVersion"]</span></div>
                                }
                                else if (Model.ChapterVersion.VersionType == ChapterTypeVersionsEnum.DraftVersion)
                                {
                                    <div class="version_capitulo version_borrador"><span class="fas fa-eraser"></span>@L["ChapterDetails.DraftVersion"]</div>
                                }
                                else
                                {
                                    <div class="version_capitulo version_no_vigente"><span class="fas fa-exclamation-circle"></span>@L["ChapterDetails.NoCurrentVersion"]</div>
                                }

                                @if (Model.ChapterVersion.IdChapterNavigation?.ChapterVersion?.Count > 1)
                                {
                                    <button type="button" class="btn btn-link btn-dark p-2" data-toggle="modal" data-target=".bd-example-modal-lg"> <span class="fas fa-exchange-alt"></span>@L["ChapterDetails.ChangeVersion"]</button>
                                }
                            </div>
                        </div>
                    </div>
                    <div class="nav-tabs-navigation px-3">
                        <div class="nav-tabs-wrapper">
                            <ul class="nav nav-tabs" data-tabs="tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" href="#datos-generales" data-toggle="tab">
                                        @L["ChapterDetails.GeneralData"]
                                        <div class="ripple-container"></div>
                                    </a>
                                </li>

                                <li class="nav-item"> <a class="nav-link" href="#contenidos-adicionales" data-toggle="tab">@L["ChapterDetails.OtherData"]</a> </li>

                            </ul>
                        </div>
                    </div>
                </div>

                <div class="card-body bg-white pt-3">
                    <div class="tab-content">
                        <!-- TAB DATOS GENARLES -->
                        <div class="tab-pane active" id="datos-generales">
                            <div class="container formularioDetalle">

                                <div class="row">
                                    <div class="form-group bmd-form-group col-4 col-sm-4 col-md-3 col-lg-2 disabled">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.CreateDate" class="bmd-label-floating">@L["ChapterDetails.CreationDate"]</label>
                                            <input type="text" class="form-control" id="fechaCreacion" asp-for="ChapterVersion.CreateDate" />
                                        </div>
                                    </div>

                                    <div class="form-group bmd-form-group col-4 col-sm-4 col-md-3 col-lg-2 disabled">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.UpdateDate" class="bmd-label-floating">@L["ChapterDetails.UpdateDate"]</label>
                                            <input type="text" class="form-control" id="fechaModificacion" asp-for="ChapterVersion.UpdateDate" />
                                        </div>
                                    </div>
                                    @if (!string.IsNullOrEmpty(Model.ChapterVersion.CreatedByNavigation?.CompleteName))
                                    {
                                        <div class="form-group bmd-form-group col-6 col-sm-6 col-md-4 col-lg-3 disabled">
                                            <div class="input-group">
                                                <label asp-for="ChapterVersion.CreatedByNavigation.CompleteName" class="bmd-label-floating">@L["ChaptersList.Header.CreatedBy"]</label>
                                                <input type="text" class="form-control" id="creadoPor" asp-for="ChapterVersion.CreatedByNavigation.CompleteName" />
                                            </div>
                                        </div>
                                    }
                                    <div class="form-group bmd-form-group col-4 col-sm-4 col-md-3 col-lg-2 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group is-filled">
                                            <label asp-for="ChapterVersion.ApprovementDate" class="bmd-label-floating">@L["ChaptersList.Header.ApprovementDate"]</label>
                                            <input type="text" asp-for="ChapterVersion.ApprovementDate" class="form-control datepicker @(Model.IsEditMode?"":"disabled")" id="fechaVigencia" placeholder="dd/mm/aaaa" data-date-format="DD/MM/YYYY" />
                                        </div>
                                    </div>
                                    <div class="form-group bmd-form-group col-4 col-sm-4 col-md-3 col-lg-2 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group is-filled">
                                            <label asp-for="ChapterVersion.ReviewDate" class="bmd-label-floating">@L["ChaptersList.Header.ReviewDate"]</label>
                                            <input type="text" asp-for="ChapterVersion.ReviewDate" class="form-control datepicker @(Model.IsEditMode?"":"disabled")" id="fechaVigencia" placeholder="dd/mm/aaaa" data-date-format="DD/MM/YYYY" />
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    @if (Model.ChapterVersion.Id != 0)
                                    {
                                        <div class="form-group bmd-form-group col-2 disabled">
                                            <div class="input-group">
                                                <label asp-for="ChapterVersion.IdChapterNavigation.Number" class="bmd-label-floating">@L["ChapterDetails.Chapter"]</label>
                                                <input type="text" class="form-control disabled" id="capitulo" asp-for="ChapterVersion.IdChapterNavigation.Number" required />
                                            </div>
                                        </div>
                                    }
                                    <div class="form-group bmd-form-group col-8 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.Title" class="bmd-label-floating">@L["ChapterDetails.Title"]</label>
                                            <input class="form-control" id="titulo" asp-for="ChapterVersion.Title" required />
                                        </div>
                                        <span asp-validation-for="ChapterVersion.Title" class="error"></span>
                                    </div>
                                    @if (Model.ChapterVersion.Id != 0)
                                    {
                                        <div class="form-group bmd-form-group col-2 disabled">
                                            <div class="input-group">
                                                <label asp-for="ChapterVersion.VersionNumber" class="bmd-label-floating">@L["ChapterDetails.VersionNumber"]</label>
                                                <input type="text" class="form-control" id="version" asp-for="ChapterVersion.VersionNumber" />
                                            </div>
                                        </div>
                                    }
                                </div>
                                <div class="row">
                                    <div class="form-group bmd-form-group col-6 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.CreatedByNavigation.CompleteName">@L["ChapterDetails.CreatedBy"]</label>

                                            <select class="form-control selectpicker" asp-for="ChapterVersion.ProducedByIds" multiple data-live-search="true" data-live-search-normalize="false"
                                                    data-none-results-text="@L["Common.NoResults"]" data-live-search-placeholder="@L["Common.SelectSearch"]" title="@L["Common.Select"]"
                                                    asp-items="@(Model.Dropdowns?.Users!=null?
                                                        new SelectList(Model.Dropdowns.Users,"Id","CompleteName")
                                                        :Model.ChapterVersion.CreatedByNavigation!=null?
                                                        new SelectList(new List<Core.Actions.Administration.ChapterDetails.Models.ChapterDetailsUserInfo> { Model.ChapterVersion.CreatedByNavigation },"Id","CompleteName")
                                                        :null)">
                                            </select>

                                        </div>
                                    </div>
                                    <div class="form-group bmd-form-group col-3 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.IdReviewerNavigation.CompleteName">@L["ChapterDetails.CheckedBy"]</label>

                                            <select class="form-control selectpicker" asp-for="ChapterVersion.IdReviewer" data-live-search="true" data-live-search-normalize="false"
                                                    data-none-results-text="@L["Common.NoResults"]" data-live-search-placeholder="@L["Common.SelectSearch"]" title="@L["Common.Select"]"
                                                    asp-items="@(Model.Dropdowns?.Users!=null?
                                                        new SelectList(Model.Dropdowns.Users,"Id","CompleteName")
                                                        :Model.ChapterVersion.IdReviewerNavigation!=null?
                                                        new SelectList(new List<Core.Actions.Administration.ChapterDetails.Models.ChapterDetailsUserInfo> { Model.ChapterVersion.IdReviewerNavigation },"Id","CompleteName")
                                                        :null)">
                                                <option value="">@L["ChapterDetails.SelectUser"]</option>
                                            </select>

                                        </div>
                                    </div>

                                    <div class="form-group bmd-form-group col-3 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group">
                                            <label asp-for="ChapterVersion.AprovedByNavigation.CompleteName">@L["ChapterDetails.AprovedBy"]</label>

                                            <select class="form-control selectpicker" asp-for="ChapterVersion.IdApprover" data-live-search="true" data-live-search-normalize="false"
                                                    data-none-results-text="@L["Common.NoResults"]" data-live-search-placeholder="@L["Common.SelectSearch"]" title="@L["Common.Select"]"
                                                    asp-items="@(Model.Dropdowns?.Users!=null?
                                                        new SelectList(Model.Dropdowns.Users,"Id","CompleteName")
                                                        :Model.ChapterVersion.AprovedByNavigation!=null?
                                                        new SelectList(new List<Core.Actions.Administration.ChapterDetails.Models.ChapterDetailsUserInfo> { Model.ChapterVersion.AprovedByNavigation },"Id","CompleteName")
                                                        :null)">
                                                <option value="">@L["ChapterDetails.SelectUser"]</option>
                                            </select>

                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">

                                        <table class="table table-bordered table-striped sortable table-hover" id="subChaptersTable">
                                            <caption>@L["ChapterDetails.Subchapters"]</caption>
                                            <thead>
                                                <tr>
                                                    <th>@L["ChapterDetails.Subchapter"] <i class="icon sort"></i></th>
                                                    <th>@L["ChapterDetails.Title"] <i class="icon sort"></i></th>
                                                    <th class="text-center">@L["Common.Actions"]</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.ChapterVersion?.SubChapterVersion != null)
                                                {
                                                    foreach (var subChapterVersion in Model.ChapterVersion?.SubChapterVersion)
                                                    {
                                                        <tr class="table-row" id="subChapterTr_@subChapterVersion.Number">
                                                            @*<td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/SubChapterDetails/Index",new { SubChapterVersionId = subChapterVersion.Id })'">@subChapterVersion.IdSubChapter</td>*@
                                                            <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/SubChapterDetails/Index",new { SubChapterVersionId = subChapterVersion.Id })'">@subChapterVersion.Number</td>
                                                            <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/SubChapterDetails/Index",new { SubChapterVersionId = subChapterVersion.Id })'">@subChapterVersion.Title</td>
                                                            <td class="text-center">
                                                                <a class="nav-link @(Model.IsEditMode? "" : "disabled") " href="#" id="navbarDropdownProfile2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                                    <span class="fas fa-ellipsis-v"></span>

                                                                </a>
                                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile2">
                                                                    <a class="dropdown-item" asp-page="/Models/Administration/ChaptersAndActivities/SubChapterDetails/Index" asp-route-subChapterVersionId="@subChapterVersion.Id" asp-route-isEditMode="true">@L["General.Table.Edit"]</a>
                                                                    @if (Model.IsEditMode)
                                                                    {
                                                                        <div class="dropdown-divider"></div>
                                                                        <a class="dropdown-item" onclick="fillRemoveSubChaptersInput(@subChapterVersion.IdSubChapter,'subChapterTr_@subChapterVersion.Number')">@L["General.Boton.Eliminar"]</a>
                                                                    }
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            </tbody>
                                        </table>
                                        @if (Model.IsEditMode)
                                        {
                                            <p class="mt-4 mb-5"><button class="btn anadir centro" asp-route-saveMode="@nameof(SaveMode.AddSubChapter)"><span class="fas fa-plus"></span>@L["ChapterDetails.AddSubchapter"]</button></p>
                                        }
                                    </div>
                                </div>

                            </div>
                        </div>

                        <!-- TAB CONTENIDOS ADICIONALES -->
                        <div class="tab-pane" id="contenidos-adicionales">
                            <div class="container formularioDetalle">

                                <div class="row ">
                                    <div class="form-group bmd-form-group col-12 m-0 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group ">
                                            <label asp-for="ChapterVersion.WorkDetails">@L["ChapterDetails.WorkDescription"]</label>
                                            @*class="summernote"*@
                                            <textarea class="form-control summernote" asp-for="ChapterVersion.WorkDetails"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <div class="row ">
                                    <div class="form-group bmd-form-group col-12 m-0 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group ">
                                            <label asp-for="ChapterVersion.WorkOrganization">@L["ChapterDetails.WorkOrganization"]</label>
                                            @*class="summernote"*@
                                            <textarea class="form-control summernote" asp-for="ChapterVersion.WorkOrganization"></textarea>
                                        </div>
                                    </div>
                                </div>

                                @*Comentado a la espera de saber que campo es y filestream*@
                                @*<div class="row">
                                        <div class="col-12">
                                            <div class="form-group bmd-form-group">
                                                <div class="input-group ">
                                                    <label class="bmd-label-floating">Detalles asociados</label>
                                                </div>
                                            </div>
                                             Upload Finished
                                            <div class="js-upload-finished">
                                                <ul class="filenames" id="filenames">
                                                </ul>
                                            </div>
                                            <div class="card documentacion">
                                                <div class="card-body" onClick="document.getElementById('inputFile').click()">
                                                    <div class="upload-drop-zone" id="drop-zone"> <i class="fas fa-cloud-upload-alt"></i> Arrastrar archivos o clic para añadir </div>
                                                </div>
                                            </div>
                                            <div class="form-group file">
                                                <label class="sr-only" for="inputFile">Adjuntar documentación</label>
                                                <input type="file" id="inputFile" accept="*" data-title="Drag and drop a file" multiple>
                                            </div>
                                        </div>
                                    </div>*@


                                <div class="row ">
                                    <div class="form-group bmd-form-group col-12 m-0 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group ">
                                            <label asp-for="ChapterVersion.MachineTool">@L["ChapterDetails.MachineTool"]</label>
                                            @*class="summernote"*@
                                            <textarea class="form-control summernote" asp-for="ChapterVersion.MachineTool"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row ">
                                    <div class="form-group bmd-form-group col-12 m-0 @(Model.IsEditMode?"":"disabled")">
                                        <div class="input-group ">
                                            <label asp-for="ChapterVersion.WordDescription">@L["ChapterDetails.Text"]</label>
                                            @*class="summernote"*@
                                            <textarea class="form-control summernote" asp-for="ChapterVersion.WordDescription"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        @*<a href="#back-top" class="elec-btn-scrollup btn btn-fab btn-round"><span class="fas fa-angle-up"></span></a>*@

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer-formularioDetalle">
        <div class="container-fluid">
            <div class="row px-4 align-items-center">
                <div class="col-auto">
                    <ul class="list-inline">

                        @if (Model.IsEditMode)
                        {
                            <li class="list-inline-item">
                                <button class="btn btn-link btn-dark p-2" type="button" data-toggle="modal" data-target="#eliminarCapitulo">
                                    <span class="fas fa-trash-alt"></span>@L["General.Boton.Eliminar"]
                                    <div class="ripple-container"></div>
                                </button>
                            </li>
                        }
                    </ul>
                </div>
                <div class="col-auto ml-auto">
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <a class="btn btn-default" asp-page="/Models/Administration/ChaptersAndActivities/List/ActivityList">@L["General.Boton.Cerrar"]</a>
                        </li>
                        @if (Model.IsEditMode)
                        {
                            <li class="list-inline-item">
                                <div class="btn-group">
                                    <button class="btn btn-primary" asp-route-saveMode="@nameof(SaveMode.Save)">
                                        @L["General.Boton.Guardar"]
                                    </button>
                                </div>
                            </li>
                            @*SaveAndNewSaveAndClose*@
                            @*<li class="list-inline-item">
                                    <div class="btn-group">
                                        <button class="btn btn-primary" asp-route-saveMode="@nameof(SaveMode.Save)">
                                            @L["General.Boton.Guardar"]
                                        </button>
                                        <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span class="sr-only">Toggle Dropdown</span>
                                        </button>
                                        <div class="dropdown-menu">
                                            <button class="dropdown-item" asp-route-saveMode="@nameof(SaveMode.SaveAndClose)">@L["General.Boton.GuardarYCerrar"]</button>
                                            <button class="dropdown-item" type="button" data-target="#saveAndNewModal" data-toggle="modal">@L["General.Boton.GuardarYNuevo"]</button>
                                        </div>
                                    </div>
                                </li>*@
                        }

                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal notificacion fade" id="eliminarCapitulo" tabindex="-1" role="dialog" aria-labelledby="eliminarCapitulo" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title error">@L["ChapterDetails.DeleteChapter"]</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row mt-4">
                        <p class="text-center">@L["ChapterDetails.DeteleChapter.Message"]</p>
                    </div>

                    <div class="row mt-4">
                        <div class="col-6">
                            <button class="btn btn-primary btn-lg col-12" asp-page="/Models/Administration/ChaptersAndActivities/List/ActivityList" name="chapterToRemoveId" value="@Model.ChapterVersion.IdChapterNavigation.Id">
                                @L["Common.Accept"]
                                <div class="ripple-container"></div>
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="btn btn-default btn-lg col-12" data-dismiss="modal">
                                @L["Common.Cancel"]
                                <div class="ripple-container"></div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Delete Modal -->
    <!-- Modal Save and New-->
    @*<div class="modal notificacion fade" id="saveAndNewModal" tabindex="-1" role="dialog" aria-labelledby="saveAndNewModal" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title error">@L["ChapterDetails.NewChapterTitle"]</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar"> <span aria-hidden="true">&times;</span> </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <input asp-for="CreateChapterTitle" value="" maxlength="250" class="form-control justify-content-center" required />
                        </div>
                        <div class="row mt-4">
                            <div class="col-6">
                                <button class="btn btn-default btn-lg col-12" data-dismiss="modal">
                                    @L["Common.Cancel"]
                                    <div class="ripple-container"></div>
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-primary btn-lg col-12" asp-route-saveMode="@nameof(SaveMode.SaveAndNew)">
                                    @L["Common.Create"]
                                    <div class="ripple-container"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>*@
    <!-- Modal Save and New-->

</form>

<!-- Modal Create SubChapter-->
@*<form asp-page="/Models/Administration/ChaptersAndActivities/SubChapterDetails/Index" method="get">
        <div class="modal notificacion fade" id="createSubChapter" tabindex="-1" role="dialog" aria-labelledby="createSubChapter" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title error">@L["SubChapterDetails.NewSubChapterTitle"]</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar"> <span aria-hidden="true">&times;</span> </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <input name="createSubChapterTitle" type="text" maxlength="250" class="form-control justify-content-center" required />
                            <input type="hidden" name="chapterId" value="@Model.ChapterVersion.IdChapterNavigation.Id" />
                            <input type="hidden" name="chapterVersionId" value="@Model.ChapterVersion.Id" />
                        </div>
                        <div class="row mt-4">
                            <div class="col-6">
                                <button class="btn btn-default btn-lg col-12" data-dismiss="modal">
                                    @L["Common.Cancel"]
                                    <div class="ripple-container"></div>
                                </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-primary btn-lg col-12">
                                    @L["Common.Create"]
                                    <div class="ripple-container"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>*@
<!-- /Modal Create SubChapter-->
<!-- DeleteVersionForm -->
<form asp-page-handler="DeleteChapterVersion" id="deleteVersionForm" data-ajax="true" data-ajax-method="POST" method="post" data-ajax-update="#otherVersionsTable" data-ajax-mode="replace">
    <input type="hidden" id="deleteVersionInput" name="versionId" />
    <input type="hidden" name="showingVersionId" value="@Model.ChapterVersion.Id" />
    <input type="hidden" name="chapterId" value="@Model.ChapterVersion.IdChapterNavigation.Id" />
    <input type="submit" id="submitButton" style="display:none" />
</form>
<!-- /DeleteVersionForm-->
<!-- Modal -->
<div class="content planes">
    <div class="modal fade bd-example-modal-lg modal-planos" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <!-- <h4 class="modal-title">Modal Heading</h4> -->
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="otherVersionsTable">
                        <table class="table table-bordered table-striped sortable table-hover" id="example">
                            <thead>
                                <tr>
                                    <th>@L["ChapterDetails.Chapter"] <i class="icon sort"></i></th>
                                    <th>@L["ChapterDetails.Title"] <i class="icon sort"></i></th>
                                    <th>@L["ChaptersList.Header.ApprovementDate"]<i class="icon sort"></i></th>
                                    <th>@L["ChapterDetails.VersionNumber"] <i class="icon sort"></i></th>
                                    <th>@L["Common.Actions"] </th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model.ChapterVersion?.IdChapterNavigation?.ChapterVersion != null)
                                {
                                    Model.ChapterVersion.IdChapterNavigation.ChapterVersion = Model.ChapterVersion?.IdChapterNavigation?.ChapterVersion.OrderBy(x => x.ApprovementDate).OrderByDescending(x => x.ApprovementDate.HasValue).ToList();
                                    foreach (var chapterVersion in Model.ChapterVersion.IdChapterNavigation.ChapterVersion)
                                    {
                                        if (chapterVersion.Id != Model.ChapterVersion.Id)
                                        {
                                            <tr class="table-row" data-href="segurplan_capitulosyactividades_capitulo.html">
                                                <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/ChapterDetails/Index",new { ChapterVersionId = chapterVersion.Id })'">@Model.ChapterVersion.IdChapter</td>
                                                <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/ChapterDetails/Index",new { ChapterVersionId = chapterVersion.Id })'">@chapterVersion.Title</td>
                                                <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/ChapterDetails/Index",new { ChapterVersionId = chapterVersion.Id })'">@chapterVersion.ApprovementDate?.ToString("dd/MM/yyyy")</td>
                                                <td onclick="location.href='@Url.Page("/Models/Administration/ChaptersAndActivities/ChapterDetails/Index",new { ChapterVersionId = chapterVersion.Id })'">@chapterVersion.VersionNumber</td>
                                                <td class="text-center">
                                                    <a class="nav-link" href="#" id="navbarDropdownProfile2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                        <span class="fas fa-ellipsis-v"></span>
                                                    </a>
                                                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile2">
                                                        <a class="dropdown-item" asp-page="/Models/Administration/ChaptersAndActivities/ChapterDetails/Index" asp-route-chapterVersionId="@chapterVersion.Id">@L["General.Table.Visualize"]</a>
                                                        <a class="dropdown-item" asp-page="/Models/Administration/ChaptersAndActivities/ChapterDetails/Index" asp-route-chapterVersionId="@chapterVersion.Id" asp-route-isEditMode="true">@L["General.Table.Edit"]</a>
                                                        <div class="dropdown-divider"></div>
                                                        <a class="dropdown-item" href="#" onclick="submitDeleteVersion(@chapterVersion.Id)">@L["General.Boton.Eliminar"]</a>
                                                    </div>
                                                </td>
                                            </tr>
                                        }

                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/assets/js/plugins/sweetalert2.js"></script>

<script>
    const removeSubchaptersInput = document.getElementById("removeSubchapterIds");
    const subChaptersTable = document.getElementById("subChaptersTable");
    function fillRemoveSubChaptersInput(id, rowId) {

        if (removeSubchaptersInput.value === "") {
            removeSubchaptersInput.value = id;
        } else {
            removeSubchaptersInput.value += "," + id;
        }

        subChaptersTable.deleteRow(document.getElementById(rowId).rowIndex);
    }

    function submitDeleteVersion(versionId, chapterId) {
        deleteInput = document.getElementById('deleteVersionInput');
        deleteForm = document.getElementById('deleteVersionForm');
        deleteSubmit = document.getElementById('submitButton');

        deleteInput.value = versionId;
        deleteSubmit.click();
    }

    function DeleteChapterAlert(chapterId) {
        swal({
                 title: "@L["DeleteChapterCheckModal.Title"]",
            text: "@L["DeleteChapterCheckModal.Text"]",
            type: "warning",
            showCancelButton: true,
            confirmButtonClass: "btn-danger",
            confirmButtonText: "@L["DeleteChapterCheckModal.Delete"]",
            cancelButtonText: "@L["DeleteChapterCheckModal.Cancel"]"
            }).then(function () {
                var url = '@Url.Page("/Models/Administration/ChaptersAndActivities/List/ActivityList",new { ChapterToRemoveId = "param-id" })';

                url = url.replace("param-id", chapterId)

                location.href = url;
               //success method
            })
    }
</script>